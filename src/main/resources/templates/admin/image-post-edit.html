<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>관리자 - 이미지 게시글 수정</title>
    <style>
        body { font-family: system-ui, sans-serif; max-width: 700px; margin: 0 auto; padding: 2rem; }
        h1 { margin-bottom: 1rem; }
        .nav { margin-bottom: 1.5rem; }
        .nav a { margin-right: 1rem; color: #2563eb; text-decoration: none; }
        .nav a:hover { text-decoration: underline; }
        .form-group { margin-bottom: 1rem; }
        .form-group label { display: block; margin-bottom: 0.25rem; font-weight: 600; }
        .form-group input, .form-group textarea { width: 100%; padding: 0.5rem; box-sizing: border-box; }
        .form-group textarea { min-height: 120px; }
        .form-group img { max-width: 300px; max-height: 200px; object-fit: contain; display: block; margin-top: 0.5rem; }
        .btn { padding: 0.5rem 1rem; cursor: pointer; border: none; border-radius: 6px; font-size: 1rem; }
        .btn-primary { background: #2563eb; color: white; }
        .btn-secondary { background: #e2e8f0; color: #333; text-decoration: none; display: inline-block; }
        .message { color: #059669; margin-bottom: 1rem; }
        .error { color: #dc2626; margin-bottom: 1rem; }
        .notice-badge { background: #f59e0b; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.875rem; margin-left: 0.5rem; }
        .notice-form { display: inline; margin-left: 0.5rem; }
    </style>
</head>
<body>
    <nav class="nav">
        <a th:href="@{/}">← 지도</a>
        <a th:href="@{/admin/members}">회원 관리</a>
        <a th:href="@{/admin/posts}">게시글 관리</a>
        <a th:href="@{/admin/image-posts}">이미지 게시글 관리</a>
    </nav>

    <p th:if="${message}" class="message" th:text="${message}"></p>
    <p th:if="${error}" class="error" th:text="${error}"></p>
    <h1>이미지 게시글 수정 <span th:if="${post.notice}" class="notice-badge">공지</span></h1>

    <form th:action="@{/admin/image-posts/{id}(id=${post.id})}" method="post" enctype="multipart/form-data">
        <div class="form-group">
            <label>현재 이미지</label>
            <img th:src="${post.imageUrl}" alt="현재 이미지" />
        </div>
        <div class="form-group">
            <label for="title">제목</label>
            <input type="text" id="title" name="title" th:value="${post.title}" required maxlength="200" />
        </div>
        <div class="form-group">
            <label for="content">내용</label>
            <textarea id="content" name="content" th:text="${post.content}" required></textarea>
        </div>
        <div class="form-group">
            <label for="image">이미지 변경 (선택)</label>
            <input type="file" id="image" name="image" accept="image/*" />
        </div>
        <button type="submit" class="btn btn-primary">저장</button>
        <a th:href="@{/admin/image-posts}" class="btn btn-secondary">목록</a>
    </form>
    <span style="margin-left: 0.5rem;" th:if="${post.notice}">
        <form th:action="@{/admin/image-posts/{id}/notice(id=${post.id}, notice=false)}" method="post" class="notice-form" style="display:inline;" onsubmit="return confirm('공지를 해제하시겠습니까?');">
            <button type="submit" class="btn btn-secondary">공지 해제</button>
        </form>
    </span>
    <span style="margin-left: 0.5rem;" th:unless="${post.notice}">
        <form th:action="@{/admin/image-posts/{id}/notice(id=${post.id}, notice=true)}" method="post" class="notice-form" style="display:inline;">
            <button type="submit" class="btn btn-secondary">공지 등록</button>
        </form>
    </span>

    <p style="margin-top: 1rem;">
        <a th:href="@{/image-posts/{id}(id=${post.id})}" th:text="'상세 보기 (이미지 게시글 ' + ${post.id} + ')'">상세 보기</a>
    </p>
</body>
</html>
